<div class="recommend-offers-card">
    <div class="title__container">
        <h6 class="left-title title subcolunmtext pl-2">{{'lang.discount_config.impact_table' | translate}}</h6>
        <!-- <span class="viewkpi" (click)="viewKpi()">({{'lang.help.viewKpi' | translate}})</span> -->
        <div class="drop_down_cont">
            <div class="select_cont">
                <span class="impact_title">{{'lang.discount_config.kpiType' | translate}}</span>
                <ng-select class="form-control" class="form-control startdt" (ngModelChange)="kpiChangeEvent($event)"
                    [(ngModel)]="selectedKpiValue">
                    <ng-option [value]="1">{{'lang.rec_discount.change' | translate}}</ng-option>
                    <ng-option [value]="2">{{'lang.rec_discount.base_value' | translate}}</ng-option>
                    <ng-option [value]="3">{{'lang.rec_discount.scenario_value' | translate}}</ng-option>
                    <ng-option [value]="4">{{'lang.rec_discount.lift_value' | translate}}</ng-option>

                </ng-select>
            </div>
            <div class="excel-card">
                <img src="assets/offer-configuration/excel.png" class="excel" alt="Excel" (click)="exportDownloadDto()">
                <h6 class="excelcont excel_font cursorhand" (click)="exportDownloadDto()">
                    {{'lang.scenario_planner.exportimpact' | translate}}</h6>
            </div>
        </div>
    </div>
    <div class="col-12 container__row p-0 boxstyleimpact">
        <table mat-table [dataSource]="dataSourceimpact" class="width w-100 col-12 offer_package_table">
            <ng-container matColumnDef="sno">
                <th mat-header-cell *matHeaderCellDef><b class="clrblack">{{'lang.discount_config.sl' | translate}}</b>
                </th>
                <td mat-cell *matCellDef="let row; let i = index">{{i+1}}
                </td>
            </ng-container>
            <ng-container matColumnDef="geo">
                <th mat-header-cell *matHeaderCellDef> <b class="clrblack">{{'lang.discount_config.region' |
                        translate}}</b>
                </th>
                <td mat-cell *matCellDef="let row"> {{row.coop_name}} </td>
            </ng-container>

            <ng-container matColumnDef="promo_type">
                <th mat-header-cell *matHeaderCellDef> <b class="clrblack">{{'lang.discount_config.pro_type' |
                        translate}}</b>
                </th>
                <td mat-cell *matCellDef="let row"> {{row.promo_type}} </td>
            </ng-container>

            <ng-container matColumnDef="gc_value">
                <th mat-header-cell *matHeaderCellDef >
                    <b class="clrblack">{{'lang.discount_config.gc' |
                        translate}}&nbsp;
                        <span *ngIf="selectedKpiValue == 1">(%)
                        </span>
                    </b>
                </th>
                <!-- {{fixedFormat(row.gc_lift)}} -->
                <td mat-cell *matCellDef="let row">
                    <span class="m-0" *ngIf="selectedKpiValue == 1 && row.metric_type.lift.gc != null">
                        {{row.metric_type.lift.gc | number :'2.1-1'}}
                    </span>
                    <span class="m-0"
                        *ngIf="selectedKpiValue == 2 && row.metric_type.base_value.gc != null">{{row.metric_type.base_value.gc
                        | number :'0.2-2'}}</span>
                    <span class="m-0"
                        *ngIf="selectedKpiValue == 3 && row.metric_type.scenario_value.gc != null">{{row.metric_type.scenario_value.gc
                        | number :'0.2-2'}}</span>
                    <span class="m-0"
                        *ngIf="selectedKpiValue == 4 && row.metric_type.lift_value.gc != null">{{row.metric_type.lift_value.gc
                        | number :'0.2-2'}}</span>
                </td>
            </ng-container>
            <!-- <ng-container matColumnDef="uc_value">
                <th mat-header-cell *matHeaderCellDef> <b class="clrblack">{{'lang.discount_config.uc' |
                        translate}}&nbsp;<span *ngIf="selectedKpiValue == 1">(%)</span></b>
                </th>
                <td mat-cell *matCellDef="let row"> -->
            <!--{{selectedKpiValue == 2 ?row.uc_scenario:row.uc_lift}}-->
            <!-- <span class="m-0"
                        *ngIf="selectedKpiValue == 1 && row.uc_lift != null">{{fixedFormat(row.uc_lift)}}</span><span
                        class="m-0" *ngIf="selectedKpiValue == 1 && row.uc_lift == null">-</span>
                    <span class="m-0" *ngIf="selectedKpiValue == 2 && row.uc_scenario == null">-</span>
                    <span class="m-0" *ngIf="selectedKpiValue == 2 && row.uc_scenario != null">{{row.uc_scenario}}</span>
                </td>
            </ng-container> -->

            <ng-container matColumnDef="sales">
                <th mat-header-cell *matHeaderCellDef>
                    <b class="clrblack">
                        {{'lang.discount_config.sales' | translate}}&nbsp;
                        <span *ngIf="selectedKpiValue == 1">(%)</span>
                        <span *ngIf="selectedKpiValue == 2">({{currencyCode}})</span>
                        <span *ngIf="selectedKpiValue == 3">({{currencyCode}})</span>
                        <span *ngIf="selectedKpiValue == 4">({{currencyCode}})</span>
                    </b>
                </th>
                <td mat-cell *matCellDef="let row">
                    <span class="m-0" *ngIf="selectedKpiValue == 1 && row.metric_type.lift.sales != null">
                        {{row.metric_type.lift.sales | number :'2.1-1'}}
                    </span>
                    <span class="m-0"
                        *ngIf="selectedKpiValue == 2 && row.metric_type.base_value.sales != null">{{row.metric_type.base_value.sales
                        | number :'0.2-2'}}</span>
                    <span class="m-0"
                        *ngIf="selectedKpiValue == 3 && row.metric_type.scenario_value.sales != null">{{row.metric_type.scenario_value.sales
                        | number :'0.2-2'}}</span>
                    <span class="m-0"
                        *ngIf="selectedKpiValue == 4 && row.metric_type.lift_value.sales != null">{{row.metric_type.lift_value.sales
                        | number :'0.2-2'}}</span>
                </td>
            </ng-container>


            <ng-container matColumnDef="gp_value">
                <th mat-header-cell *matHeaderCellDef>
                    <b class="clrblack">
                        {{'lang.discount_config.gp' | translate}}&nbsp;
                        <span *ngIf="selectedKpiValue == 1">(%)</span>
                        <span *ngIf="selectedKpiValue == 2">({{currencyCode}})</span>
                        <span *ngIf="selectedKpiValue == 3">({{currencyCode}})</span>
                        <span *ngIf="selectedKpiValue == 4">({{currencyCode}})</span>
                    </b>
                </th>
                <td mat-cell *matCellDef="let row">
                    <span class="m-0" *ngIf="selectedKpiValue == 1 && row.metric_type.lift.gp != null">
                        {{row.metric_type.lift.gp | number :'2.1-1'}}
                    </span>
                    <span class="m-0"
                        *ngIf="selectedKpiValue == 2 && row.metric_type.base_value.gp != null">{{row.metric_type.base_value.gp
                        | number :'0.2-2'}}</span>
                    <span class="m-0"
                        *ngIf="selectedKpiValue == 3 && row.metric_type.scenario_value.gp != null">{{row.metric_type.scenario_value.gp
                        | number :'0.2-2'}}</span>
                    <span class="m-0"
                        *ngIf="selectedKpiValue == 4 && row.metric_type.lift_value.gp != null">{{row.metric_type.lift_value.gp
                        | number :'0.2-2'}}</span>
                </td>
            </ng-container>

            <ng-container matColumnDef="average_check">
                <th mat-header-cell *matHeaderCellDef>
                    <b class="clrblack">{{'lang.discount_config.avgcheck' | translate}}&nbsp;
                        <span *ngIf="selectedKpiValue == 1">(%)</span>
                        <span *ngIf="selectedKpiValue == 2">({{currencyCode}})</span>
                        <span *ngIf="selectedKpiValue == 3">({{currencyCode}})</span>
                        <span *ngIf="selectedKpiValue == 4">({{currencyCode}})</span>
                    </b>
                </th>
                <td mat-cell *matCellDef="let row">
                    <span class="m-0" *ngIf="selectedKpiValue == 1 && row.metric_type.lift.acv != null">
                        {{row.metric_type.lift.acv | number :'2.1-1'}}
                    </span>
                    <span class="m-0"
                        *ngIf="selectedKpiValue == 2 && row.metric_type.base_value.acv != null">{{row.metric_type.base_value.acv
                        | number :'0.2-2'}}</span>
                    <span class="m-0"
                        *ngIf="selectedKpiValue == 3 && row.metric_type.scenario_value.acv != null">{{row.metric_type.scenario_value.acv
                        | number :'0.2-2'}}</span>
                    <span class="m-0"
                        *ngIf="selectedKpiValue == 4 && row.metric_type.lift_value.acv != null">{{row.metric_type.lift_value.acv
                        | number :'0.2-2'}}</span>
                </td>
            </ng-container>

            <!-- <ng-container matColumnDef="net_sales">
                <th mat-header-cell *matHeaderCellDef><b class="clrblack">{{'lang.discount_config.netsale' |
                        translate}}<span *ngIf="selectedKpiValue == 1">(%)</span>
                        <span *ngIf="selectedKpiValue == 2">({{currencyCode}})</span></b></th>
                <td mat-cell *matCellDef="let row">
                    <span class="m-0"
                        *ngIf="selectedKpiValue == 1 && row.netsales_lift != null">{{fixedFormat(row.netsales_lift)}}</span><span
                        class="m-0" *ngIf="selectedKpiValue == 1 && row.netsales_lift == null">-</span>
                    <span class="m-0" *ngIf="selectedKpiValue == 2 && row.netsales_scenario == null">-</span>
                    <span class="m-0"
                        *ngIf="selectedKpiValue == 2 && row.netsales_scenario != null">{{row.netsales_sc}}</span>
                </td>
            </ng-container> -->

            <!-- <ng-container matColumnDef="effect">
                <th mat-header-cell *matHeaderCellDef><b class="clrblack">{{'lang.discount_config.effectmarg' |
                        translate}}&nbsp;<span *ngIf="selectedKpiValue == 1">(%)</span></b> </th>
                <td mat-cell *matCellDef="let row">
                    <span class="m-0"
                        *ngIf="selectedKpiValue == 1 && row.effect_on_margin_lift != null">{{fixedFormat(row.effect_on_margin_lift)}}</span><span
                        class="m-0" *ngIf="selectedKpiValue == 1 && row.effect_on_margin_lift == null">-</span>
                    <span class="m-0"
                        *ngIf="selectedKpiValue == 2 && (row.effect_on_margin_scenario == null || row.effect_on_margin_scenario == 0)">-</span>
                    <span class="m-0"
                        *ngIf="selectedKpiValue == 2 && (row.effect_on_margin_scenario != null && row.effect_on_margin_scenario != 0)">{{row.effect_on_margin_scenario
                        | currencyformat}}</span>
                </td>
            </ng-container> -->
            <ng-container matColumnDef="upt">
                <th mat-header-cell *matHeaderCellDef>
                    <b class="clrblack">{{'lang.discount_config.upt' | translate}}&nbsp;
                        <span *ngIf="selectedKpiValue == 1">(%)</span>
                        <span *ngIf="selectedKpiValue == 2">({{currencyCode}})</span>
                        <span *ngIf="selectedKpiValue == 3">({{currencyCode}})</span>
                        <span *ngIf="selectedKpiValue == 4">({{currencyCode}})</span>
                    </b>
                </th>
                <td mat-cell *matCellDef="let row">
                    <span class="m-0" *ngIf="selectedKpiValue == 1 && row.metric_type.lift.upt != null">
                        {{row.metric_type.lift.upt | number :'2.1-1'}}
                    </span>
                    <span class="m-0"
                        *ngIf="selectedKpiValue == 2 && row.metric_type.base_value.upt != null">{{row.metric_type.base_value.upt
                        | number :'0.2-2'}}</span>
                    <span class="m-0"
                        *ngIf="selectedKpiValue == 3 && row.metric_type.scenario_value.upt != null">{{row.metric_type.scenario_value.upt
                        | number :'0.2-2'}}</span>
                    <span class="m-0"
                        *ngIf="selectedKpiValue == 4 && row.metric_type.lift_value.upt != null">{{row.metric_type.lift_value.upt
                        | number :'0.2-2'}}</span>
                </td>
            </ng-container>
            <!-- <ng-container matColumnDef="urv">
                <th mat-header-cell *matHeaderCellDef><b class="clrblack">{{'lang.discount_config.urw' |
                        translate}}&nbsp;<span *ngIf="selectedKpiValue == 1">(%)</span></b> </th>
                <td mat-cell *matCellDef="let row">
                    <span class="m-0"
                        *ngIf="selectedKpiValue == 1 && row.urw_lift != null">{{fixedFormat(row.urw_lift)}}</span><span
                        class="m-0" *ngIf="selectedKpiValue == 1 && row.urw_lift == null">-</span>
                    <span class="m-0" *ngIf="selectedKpiValue == 2 && row.urw_scenario == null">-</span>
                    <span class="m-0" *ngIf="selectedKpiValue == 2 && row.urw_scenario != null">{{
                        row.urw_scenario}}</span>
                </td>
            </ng-container> -->

            <tr mat-header-row *matHeaderRowDef="displayedColumnsimpact"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumnsimpact;"></tr>

            <!-- Row shown when there is no matching data. -->
            <tr class="mat-row" *matNoDataRow>
                <td class="mat-cell" colspan="7">{{'lang.discount_config.Nodata' | translate}}</td>
            </tr>

        </table>

    </div>
    <!-- <p>As per the definition of Effect on Margin (Margin delta/Net Sales delta)</p> -->
    <!-- <div class="note" *ngIf="selectedKpiValue == 1"><i>*{{impactNote}}*</i></div> -->
</div>