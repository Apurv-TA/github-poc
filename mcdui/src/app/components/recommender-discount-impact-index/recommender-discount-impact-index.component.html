<!-- Impact Index Popup -->
<ng-template #impactModel let-modal>
    <div class="modal-header impact_index">
        <h6 class="modal-title" id="modal-basic-title">{{'lang.help.impact_index' |
            translate}}</h6>

        <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
            <span aria-hidden="true">Ã—</span>
        </button>
    </div>
    <div class="modal-body prodscroll">
        <form [formGroup]="impactIndexForm">
            <div formArrayName="impact_index" class="height">
                <div class="row">
                    <ng-container *ngFor="let impact of impactIndexForm.get('impact_index')['controls']; let i = index;"
                        [formGroupName]="i">
                        <div class="col-md-3">
                            <label class="label" *ngIf="i==0">{{'lang.help.Segment Name' |
                                translate}}</label><br>
                            <label class="segment-label py-2"> {{impactIndexForm.getRawValue().impact_index[i].segment_name}} </label>
                        </div>
                        <div class="col-md-9"
                            [ngClass]="{'error_discount_price' : impactIndexForm.getRawValue().impact_index[i].is_validform }">
                            <div class="col-sm-3 left">
                                <label class="label"
                                    [ngClass]="{'error_discount_price' : impactIndexForm.getRawValue().impact_index[i].is_validform }"
                                    *ngIf="i==0">{{'lang.help.guestCount' |
                                    translate}}</label><br>
                                <mat-form-field appearance="outline">
                                    <input autocomplete="off" class="inputtxt" formControlName="gc" [readonly]="is_edit"
                                        (keyup)="sumGcValue()" [min]="0" [max]="1.1" matInput type="number"
                                        [ngClass]="{'error_discount_price' : impactIndexForm.getRawValue().impact_index[i].is_validform }" />
                                </mat-form-field>
                            </div>
                            <div class="col-sm-3 netleft">
                                <label class="label"
                                    [ngClass]="{'error_discount_price' : impactIndexForm.getRawValue().impact_index[i].is_validform }"
                                    *ngIf="i==0">{{'lang.help.net_sales' |
                                    translate}}</label><br>
                                <mat-form-field appearance="outline">
                                    <input autocomplete="off" class="inputtxt" [readonly]="is_edit"
                                        (keyup)="sumNetSalesValue()" formControlName="net_sales"
                                        [ngClass]="{'error_discount_price' : impactIndexForm.getRawValue().impact_index[i].is_validform }"
                                        [min]="0" [max]="1.1" matInput type="number" />
                                </mat-form-field>
                            </div>
                            <div class="col-sm-2 netleft">
                                <label class="label"
                                    [ngClass]="{'error_discount_price' : impactIndexForm.getRawValue().impact_index[i].is_validform }"
                                    *ngIf="i==0">{{'lang.help.margin' |
                                    translate}}</label><br>
                                <mat-form-field appearance="outline">
                                    <input autocomplete="off" class="inputtxt" [readonly]="is_edit"
                                        (keyup)="sumMarginValue()" formControlName="margin"
                                        [ngClass]="{'error_discount_price' : impactIndexForm.getRawValue().impact_index[i].is_validform }"
                                        [min]="0" [max]="1.1" matInput type="number" />
                                </mat-form-field>
                            </div>
                            <mat-icon class="poniter icon-smaller"
                                [ngClass]="{'icon-none' : impactIndexForm.getRawValue().impact_index[i].is_validform }"
                                (click)="copyIndexValues(i)" *ngIf="!is_edit && impactIndexForm.getRawValue().impact_index.length > 1">
                                file_copy
                            </mat-icon>
                        </div>

                    </ng-container>
                </div>
            </div>
        </form>
    </div>
    <div class="modal-footer">
        <button mat-button color="warn" class="save_yes" [disabled]="validateImpactIndex() || is_edit"
            (click)="saveImpactIndexDTO()">{{'lang.common.submit' |
            translate}}</button>
    </div>
</ng-template>